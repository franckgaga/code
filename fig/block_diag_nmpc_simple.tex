\begin{tikzpicture}[auto,node distance=5em]

	\tikzstyle{block} = [draw,rectangle,fill=blue!10,
	                       minimum width=4em, minimum height=2em]
	\tikzstyle{mux} = [draw,fill,minimum width=1.6pt,inner sep=0]
	\tikzstyle{sum} = [draw, circle,fill=blue!10]
	
	\tikzstyle{arrow} = [semithick,->,>=stealth]
	\tikzstyle{arrowDot} = [semithick,*->,>=stealth]
	
	\tikzstyle{junction} = [shape=circle,minimum size=4pt,inner sep=0pt,fill]
	
	% ========== BLOCS et NOEUDS ============
	\node (setpoint) []{};

	\node (NMPC) [block,right of=setpoint] {NMPC};
	
    \node (FBD) [block,right of=NMPC,xshift=2em] {FBD};
    
    \node (output) [right of=FBD,xshift=3em]{};
    
    \node (model) [block,below of=FBD,yshift=+2.5em]{eq. \eqref{eq.fbd1phFG_ss}};
    
    \node (sum) [sum,right of=model,xshift=1em]{};
    
    \node (yJct) [junction] at (output -| sum){};
	
	% ========= FLÃˆCHE ==============================
	\draw [arrow] (setpoint)  -- node{\small $\mathbf{r}(k)$} (NMPC);	
		
	\draw [arrow] (NMPC) -- node[name=uTag]{\small $\mathbf{u}(k)$} (FBD);
	
	\draw [arrow] (uTag) |- (model);

	\draw [arrow] (FBD)  -- node[xshift=-1.43em] {\small $\mathbf{y}(k)$} (output);
	
	\draw [arrow] (yJct)  -- (sum.north) node[pos=0.80] {\small $+$};
	
	\draw [arrow] (model) -- node[name=ymTag]{\small $\mathbf{y_m}(k)$}
		(sum) node[pos=0.80,below] {\small $-$};
	
	\draw [arrow] (ymTag) -- ++ (0,-3em) 
		node[above,xshift=-7.25em]{\small $\mathbf{x}(k)$}
			-| (NMPC.315);
	
	\draw [arrow] (sum.south) -- ++ (0,-3.5em) 
		node[above,xshift=-9.3em]{\small $\mathbf{y}_\mathbf{s}(k)$} 
			-| (NMPC.225);
	  
	\node (uJct)  [junction] at (uTag.south){};
	\node (ymJct) [junction] at (ymTag.south){};      

\end{tikzpicture}